[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Téncicas Matemáticas en Bioinformática",
    "section": "",
    "text": "Prefacio\n¡Bienvenido al manual de Bioinformática!\nEste libro presenta una recopilación técnicas matemáticas y estadísticas aplicadas en Bioinformática. Muchas de estas técnicas están ilustradas con ejemplos y están implementadas en distintos lenguajes de programación como R, Python o Julia."
  },
  {
    "objectID": "index.html#capítulos",
    "href": "index.html#capítulos",
    "title": "Téncicas Matemáticas en Bioinformática",
    "section": "Capítulos",
    "text": "Capítulos\n\n\n\n\n\n\n\nAnálisis de expresión génica diferencial (RNA-Seq)\n\n\n\n\n\n\n\n\n\n\nDiagramas de volcán\n\n\n\n\n\n\n\nNo hay resultados"
  },
  {
    "objectID": "index.html#licencia",
    "href": "index.html#licencia",
    "title": "Téncicas Matemáticas en Bioinformática",
    "section": "Licencia",
    "text": "Licencia\nEsta obra está bajo una licencia Reconocimiento – No comercial – Compartir bajo la misma licencia 3.0 España de Creative Commons. Para ver una copia de esta licencia, visite https://creativecommons.org/licenses/by-nc-sa/3.0/es/.\nCon esta licencia eres libre de:\n\nCopiar, distribuir y mostrar este trabajo.\nRealizar modificaciones de este trabajo.\n\nBajo las siguientes condiciones:\n\nReconocimiento. Debe reconocer los créditos de la obra de la manera especificada por el autor o el licenciador (pero no de una manera que sugiera que tiene su apoyo o apoyan el uso que hace de su obra).\nNo comercial. No puede utilizar esta obra para fines comerciales.\nCompartir bajo la misma licencia. Si altera o transforma esta obra, o genera una obra derivada, sólo puede distribuir la obra generada bajo una licencia idéntica a ésta.\n\nAl reutilizar o distribuir la obra, tiene que dejar bien claro los términos de la licencia de esta obra.\nEstas condiciones pueden no aplicarse si se obtiene el permiso del titular de los derechos de autor.\nNada en esta licencia menoscaba o restringe los derechos morales del autor."
  },
  {
    "objectID": "01-rna-seq.html#análisis-de-expresión-génica-diferencial-con-edger",
    "href": "01-rna-seq.html#análisis-de-expresión-génica-diferencial-con-edger",
    "title": "1  Análisis de expresión génica diferencial (RNA-Seq)",
    "section": "1.1 Análisis de expresión génica diferencial con edgeR",
    "text": "1.1 Análisis de expresión génica diferencial con edgeR\nEl paquete edgeR es uno de los principales paquetes usados para el análisis de expresión génica diferencial que incorpora funciones para todas las etapas del análisis estadístico. Está disponible en el repositorio Bioconductor.\nA continuación se explica cómo realizar las distintas etapas del análisis estadístico con este paquete.\n\n1.1.1 Estructura de datos\nEl análisis estadístico comienza siempre a partir de la matriz con las frecuencias o conteos de expresión de cada gen en el conjunto de muestras analizadas. Las filas de esta matriz corresponden a los genes observados y las columnas a las muestras analizadas.\n\nEjemplo 1.1 A continuación se muestran las primeras filas de una matriz de frecuencias de expresión génica. Cada casilla recoge el número de veces que el gen de la fila correspondiente se ha observado en la muestra de la columna correspondiente.\n\n\n\n\n\n\n  \n    \n    \n      Gen\n      \n        Muestras\n      \n    \n    \n      sample1\n      sample2\n      sample3\n      sample4\n      sample5\n      sample6\n    \n  \n  \n    gene1\n85\n76\n103\n107\n140\n124\n    gene2\n1\n6\n11\n6\n1\n4\n    gene3\n80\n98\n39\n82\n97\n113\n    gene4\n92\n83\n59\n85\n100\n98\n    gene5\n36\n24\n18\n50\n22\n15\n    gene6\n0\n0\n1\n4\n2\n3\n  \n  \n  \n\n\n\n\n\nEl paquete edgeR utiliza la estructura de datos DGEList para guardar la matriz de frecuencias de expresión génica. Para crear esta estructura se utiliza la función\n\nDGEList(frec, group = grupo): Crea una estructura del tipo DGEList con la matriz de frecuencias de expresión génica frec (con genes en filas y muestras en columnas) y el vector grupo con los grupos experimentales a los que pertenecen las muestras analizadas en las columnas de la matriz de frecuencias.\n\n\nlibrary(edgeR)\nlibrary(DEFormats)\nfrec &lt;- simulateRnaSeqData()\ngrupo &lt;- rep(c(\"A\", \"B\"), each = 3)\ndge &lt;- DGEList(frec, group = grupo)\ndge\n\nAn object of class \"DGEList\"\n$counts\n      sample1 sample2 sample3 sample4 sample5 sample6\ngene1      85      76     103     107     140     124\ngene2       1       6      11       6       1       4\ngene3      80      98      39      82      97     113\ngene4      92      83      59      85     100      98\ngene5      36      24      18      50      22      15\n995 more rows ...\n\n$samples\n        group lib.size norm.factors\nsample1     A    42832            1\nsample2     A    40511            1\nsample3     A    39299            1\nsample4     B    43451            1\nsample5     B    40613            1\nsample6     B    43662            1\n\n\nEsta estructura de datos es una lista con dos atributos. El atributo counts contiene la matriz de frecuencias de expresión génica, y el atributo samples es un data frame con información sobre las muestras estudiadas. Cada fila de este data frame se corresponde con una columna de la matriz de frecuencias y contiene las siguientes columnas\n\n\n\n\n\n\n\nColumna\nDescripción\n\n\n\n\ngroup\nGrupo experimental al que pertenece la muestra.\n\n\nlib.size\ntamaño de la librería (suma de frecuencias de la muestra).\n\n\nnorm.factors\nFactor de normalización.\n\n\n\nLa estructura de datos DGEList puede contener opcionalmente el atributo genes con anotaciones de los genes observados en las filas de la matriz de frecuencias.\n\nEjemplo 1.2 Veamos cómo crear la estructura de datos correspondiente al estudio de Sheridan JM, et al. (2015) donde se obtuvieron datos de tres poblaciones de células (basal, progenitor luminal (LP) y luminal maduro (ML)) seleccionadas de las glándulas mamarias de ratones vírgenes hembra, cada una por triplicado. Los datos pueden obtenerse del repositorio Gene Expression Omnibus (GEO) mediante el identificador GSE63310.\nEn primer lugar cargamos la matriz de frecuencias.\n\n\nfrecuencias &lt;- read.csv(\"datos/matriz-frecuencias-genes.csv\", row.names = 1)\nhead(frecuencias)\n\n          LP1 ML1   B1   B2  ML2 LP2  B3 ML3 LP3\n497097      1   2  342  526    3   3 535   2   0\n100503874   0   0    5    6    0   0   5   0   0\n100038431   0   0    0    0    0   0   1   0   0\n19888       0   1    0    0   17   2   0   1   0\n20671       1   1   76   40   33  14  98  18   8\n27395     431 771 1368 1268 1564 769 818 468 342\n\n\nDespués cargamos los datos de las muestras con los factores experimentales.\n\nmuestras &lt;- read.csv(\"datos/muestras.csv\")\nmuestras\n\n   Id Grupo Lote\n1 LP1    LP L004\n2 ML1    ML L004\n3  B1 Basal L004\n4  B2 Basal L006\n5 ML2    ML L006\n6 LP2    LP L006\n7  B3 Basal L006\n8 ML3    ML L008\n9 LP3    LP L008\n\n\nA continuación creamos la estructura de datos DGEList.\n\n# Creación de la estructura de datos DGEList.\ndge &lt;- DGEList(counts = frecuencias, group = muestras$Grupo)\n# Añadimos también el Lote al dafa frame de las muestras.\ndge$samples$Lote &lt;- muestras$Lote\ndge\n\nAn object of class \"DGEList\"\n$counts\n          LP1 ML1  B1  B2 ML2 LP2  B3 ML3 LP3\n497097      1   2 342 526   3   3 535   2   0\n100503874   0   0   5   6   0   0   5   0   0\n100038431   0   0   0   0   0   0   1   0   0\n19888       0   1   0   0  17   2   0   1   0\n20671       1   1  76  40  33  14  98  18   8\n27174 more rows ...\n\n$samples\n    group lib.size norm.factors Lote\nLP1    LP 32863052            1 L004\nML1    ML 35335491            1 L004\nB1  Basal 57160817            1 L004\nB2  Basal 51368625            1 L006\nML2    ML 75795034            1 L006\nLP2    LP 60517657            1 L006\nB3  Basal 55086324            1 L006\nML3    ML 21311068            1 L008\nLP3    LP 19958838            1 L008\n\n\nA continuación anotamos los genes de las filas de la matriz de frecuencias. Para ello debe utilizarse un paquete específico para el genoma de la especie de donde proviene el RNA (Mus.muculus en este caso para el genoma del ratón).\n\nlibrary(Mus.musculus)\ngeneid &lt;- rownames(dge)\ngenes &lt;- select(Mus.musculus, keys = geneid, columns = c(\"SYMBOL\", \"TXCHROM\"), keytype = \"ENTREZID\")\n# Eliminamos duplicidad de algunos genes\ngenes &lt;- genes[!duplicated(genes$ENTREZID),]\ndge$genes &lt;- genes\ndge\n\nAn object of class \"DGEList\"\n$counts\n          LP1 ML1  B1  B2 ML2 LP2  B3 ML3 LP3\n497097      1   2 342 526   3   3 535   2   0\n100503874   0   0   5   6   0   0   5   0   0\n100038431   0   0   0   0   0   0   1   0   0\n19888       0   1   0   0  17   2   0   1   0\n20671       1   1  76  40  33  14  98  18   8\n27174 more rows ...\n\n$samples\n    group lib.size norm.factors Lote\nLP1    LP 32863052            1 L004\nML1    ML 35335491            1 L004\nB1  Basal 57160817            1 L004\nB2  Basal 51368625            1 L006\nML2    ML 75795034            1 L006\nLP2    LP 60517657            1 L006\nB3  Basal 55086324            1 L006\nML3    ML 21311068            1 L008\nLP3    LP 19958838            1 L008\n\n$genes\n   ENTREZID  SYMBOL TXCHROM\n1    497097    Xkr4    chr1\n2 100503874 Gm19938    &lt;NA&gt;\n3 100038431 Gm10568    &lt;NA&gt;\n4     19888     Rp1    chr1\n5     20671   Sox17    chr1\n27174 more rows ...\n\n\n\n\n\n1.1.2 Preprocesamiento\nUna vez preparada la estructura de datos, el siguiente paso es el preprocesamiento de datos. Normalmente comprende las siguientes tareas:\n\nNormalización de las frecuencias.\nEliminación de los genes con poca expresión.\nNormalización de las distribuciones de frecuencias de expresión génicas.\n\n\n1.1.2.1 Normalización de las frecuencias\nEl objetivo principal es normalizar las frecuencias de expresión génica para eliminar el efecto sobre las frecuencias de factores como la profundidad de secuenciado (a mayor profundidad de secuenciado mayores frecuencias) o el tamaño de los genes (a mayor tamaño mayores frecuencias). Generalmente se usan las siguientes transformaciones\n\nFrecuencias por millón (CPM). Se divide cada frecuencia por el tamaño en millones de la librería de la muestra a la que pertenece. Se realiza con la función cpm(dge).\nLogaritmo en base 2 de las frecuencias por millón (log2-CPM). Se calcula a partir de la anterior mediante la fórmula \\(\\log_2(CPM+\\frac{2}{L})\\), donde \\(L\\) es la longitud media de las librerías en millones. El término \\(\\frac{2}{L}\\) que se añade permite calcular el logaritmo para frecuencias nulas (ya que el logaritmo de 0 no existe). Se realiza con la función cmp(dge, log = TRUE).\nLecturas por kilobase de transcripción por millón (RPKM): Se realiza con la función rpkm(dge, longitud_genes) pasando la longitud de los genes.\nFragmentos por kilobase de transcripción por millón (FPKM).\n\nLas dos primeras no tienen en cuenta el tamaño de los genes, pero suelen usarse para la expresión génica diferencial donde el tamaño de los genes se supone constante en las distintas muestras.\n\nEjemplo 1.3 Siguiendo con el ejemplo anterior, calculamos las frecuencias por millón y el logaritmo de las frecuencias por millón.\n\ncpm &lt;- cpm(dge)\nsummary(cpm)\n\n      LP1                 ML1                  B1                 B2          \n Min.   :    0.000   Min.   :    0.000   Min.   :   0.000   Min.   :   0.000  \n 1st Qu.:    0.000   1st Qu.:    0.000   1st Qu.:   0.000   1st Qu.:   0.000  \n Median :    0.578   Median :    0.736   Median :   0.892   Median :   0.895  \n Mean   :   36.793   Mean   :   36.793   Mean   :  36.793   Mean   :  36.793  \n 3rd Qu.:   19.536   3rd Qu.:   23.546   3rd Qu.:  24.221   3rd Qu.:  23.341  \n Max.   :27807.947   Max.   :11546.719   Max.   :7951.408   Max.   :7389.433  \n      ML2                LP2                  B3                ML3          \n Min.   :   0.000   Min.   :    0.000   Min.   :   0.000   Min.   :   0.000  \n 1st Qu.:   0.000   1st Qu.:    0.000   1st Qu.:   0.000   1st Qu.:   0.000  \n Median :   0.699   Median :    0.711   Median :   0.908   Median :   0.845  \n Mean   :  36.793   Mean   :   36.793   Mean   :  36.793   Mean   :  36.793  \n 3rd Qu.:  23.827   3rd Qu.:   19.928   3rd Qu.:  21.439   3rd Qu.:  24.260  \n Max.   :7955.680   Max.   :29572.361   Max.   :9376.973   Max.   :7865.350  \n      LP3           \n Min.   :    0.000  \n 1st Qu.:    0.000  \n Median :    0.752  \n Mean   :   36.793  \n 3rd Qu.:   21.594  \n Max.   :16500.710  \n\nlcpm &lt;- cpm(dge, log = TRUE)\nsummary(lcpm)\n\n      LP1               ML1                B1                 B2         \n Min.   :-4.5074   Min.   :-4.5074   Min.   :-4.50743   Min.   :-4.5074  \n 1st Qu.:-4.5074   1st Qu.:-4.5074   1st Qu.:-4.50743   1st Qu.:-4.5074  \n Median :-0.6847   Median :-0.3589   Median :-0.09513   Median :-0.0901  \n Mean   : 0.1714   Mean   : 0.3312   Mean   : 0.43559   Mean   : 0.4089  \n 3rd Qu.: 4.2913   3rd Qu.: 4.5601   3rd Qu.: 4.60081   3rd Qu.: 4.5475  \n Max.   :14.7632   Max.   :13.4952   Max.   :12.95700   Max.   :12.8513  \n      ML2               LP2                B3                ML3         \n Min.   :-4.5074   Min.   :-4.5074   Min.   :-4.50743   Min.   :-4.5074  \n 1st Qu.:-4.5074   1st Qu.:-4.5074   1st Qu.:-4.50743   1st Qu.:-4.5074  \n Median :-0.4281   Median :-0.4064   Median :-0.07152   Median :-0.1704  \n Mean   : 0.3225   Mean   : 0.2529   Mean   : 0.40428   Mean   : 0.3708  \n 3rd Qu.: 4.5772   3rd Qu.: 4.3199   3rd Qu.: 4.42513   3rd Qu.: 4.6031  \n Max.   :12.9578   Max.   :14.8520   Max.   :13.19491   Max.   :12.9413  \n      LP3         \n Min.   :-4.5074  \n 1st Qu.:-4.5074  \n Median :-0.3300  \n Mean   : 0.2749  \n 3rd Qu.: 4.4355  \n Max.   :14.0102  \n\n\n\n\n\n1.1.2.2 Eliminación de genes con poca expresión\nAunque el objetivo del análisis de la expresión génica diferencial es detectar los genes que se expresan en un grupo experimental en comparación con los otros, cuando un gen no se expresa en ninguna de las muestras no tiene interés para el estudio y puede eliminarse.\nExisten diferentes criterios para eliminar los genes con poca expresión. El paquete EdgeR incorpora la siguiente función\n\nfilterByExpr(dge): Devuelve un vector de booleanos con nombres correspondientes a los genes de la estructura DEGList dge. Por defecto devuelve TRUE para cualquier gen con una frecuencia mayor o igual que 10 en al menos un número de muestras igual al del menor grupo experimental.\n\n\nEjemplo 1.4 Veamos cuántos genes no tienen expresión en ninguna muestra del ejemplo anterior.\n\n# Número de genes con expresión nula.\ntable(rowSums(dge$counts) == 0)  \n\n\nFALSE  TRUE \n22026  5153 \n\n\nEl siguiente gráfico muestra la distribución del logaritmo en base 2 de las frecuencias por millón.\n\n# Definimos una función para dibujar la distribución del logaritmo de las frecuencias por millón.\ndist_logcpm &lt;- function(lcpm) {\nlcpm |&gt; \n    as.tibble()  |&gt;\n    pivot_longer(everything(), names_to = \"Muestra\", values_to = \"LogCPM\") |&gt;\n    ggplot(aes(x = LogCPM, color = Muestra)) +\n    geom_density() +\n    labs(title = \"Distribución del logaritmo en base 2 de las frecuencias por millón\")\n}\n\ndist_logcpm(lcpm)\n\nWarning: `as.tibble()` was deprecated in tibble 2.0.0.\nℹ Please use `as_tibble()` instead.\nℹ The signature and semantics have changed, see `?as_tibble`.\n\n\n\n\n\nComo se observa ha una porcentaje significativo de genes que tiene una expresión muy baja (valores negativos).\nA continuación eliminamos de la estructura de datos los genes con poca expresión.\n\nfiltro &lt;- filterByExpr(dge)\ndge &lt;- dge[filtro, , keep.lib.sizes = F]\n\nY volvemos a dibujar la distribución del logaritmo en base 2 de las frecuencias por millón.\n\nlcpm &lt;- cpm(dge, log = TRUE)\ndist_logcpm(lcpm)\n\n\n\n\n\nComo se aprecia en el diagrama, el porcentaje de genes con baja expresión ha disminuido significativamente.\n\n\n1.1.2.3 Normalización de las distribuciones de frecuencias de expresión génicas\nDurante el proceso de secuenciación puede haber factores externos no biológicos que afecten a la expresión de los genes. Por ejemplo, la muestras del primer lote pueden tener mayores frecuencias que las del segundo lote. Como se supone que las muestras replicadas deben tener un rango y una distribución de frecuencias similares, en esta etapa se aplica otro procedimiento de normalización para garantizar que la distribución de frecuencias de cada muestra es similar. Para ello el paquete edgeR utiliza el método de las medias recortadas de los valores M por medio de la función\n\ncalcNormFactors(dge, method = \"TMM\"): Calcular los factores de escalado del tamaño de las librerías de cada muestra. Estos factores se guardan automáticamente en el data frame con la información de las muestras dge$samples.\n\n\nEjemplo 1.5 Siguiendo con el mismo ejemplo, calculamos los factores de escalado para cada muestra.\n\ndge &lt;- calcNormFactors(dge, method = \"TMM\")\ndge$samples\n\n    group lib.size norm.factors Lote\nLP1    LP 32857304    0.8943956 L004\nML1    ML 35328624    1.0250186 L004\nB1  Basal 57147943    1.0459005 L004\nB2  Basal 51356800    1.0458455 L006\nML2    ML 75782871    1.0162707 L006\nLP2    LP 60506774    0.9217132 L006\nB3  Basal 55073018    0.9961959 L006\nML3    ML 21305254    1.0861026 L008\nLP3    LP 19955335    0.9839203 L008\n\n\nA continuación se muestran los diagramas de cajas de las distribuciones normalizadas tras aplicar los factores de escalado.\n\nbox_logcpm &lt;- function(dge){\n  muestras &lt;- dge$samples\n  muestras$Muestra &lt;- row.names(muestras)\n  cpm(dge, log = TRUE) |&gt; \n    as.tibble() |&gt;\n    pivot_longer(everything(), names_to = \"Muestra\", values_to = \"LogCPM\") |&gt;\n    left_join(muestras, by = \"Muestra\") |&gt; \n    ggplot(aes(x = Muestra, y = LogCPM, fill = group)) +\n    geom_boxplot() +\n    labs(title = \"Distribución del logaritmo en base 2 de las frecuencias por millón\")\n}\n\nbox_logcpm(dge)\n\n\n\n\nComo se puede apreciar, después de la normalización, todas las muestras presentan una distribución de frecuencias similar.\n\n\n\n\n1.1.3 Análisis exploratorio\nUna vez preprocesados los datos comienza el análisis estadístico propiamente dicho. En una primera fase se suele realizar un análisis exploratorio de los datos que suele incluir los siguientes análisis:\n\nEscalado multidimensional (análisis de componentes principales).\n\n\n1.1.3.1 Escalado multidimensional\nEl escalado multidimensional mediante componente principales permite ver qué muestras son similares en cuando a la distribución de frecuencias de expresión génica. Los componentes principales son combinaciones lineales de los genes de la matriz de frecuencias que son ortogonales entre sí. El primer componente principal recoge la dimensión con mayor variabilidad de las frecuencias. El segundo recoge la dimensión don la mayor variabilidad no explicada por el primer componente principal y así sucesivamente. Normalmente los dos primeros componentes principales suelen recoger un porcentaje bastante alto de la variabilidad de las frecuencias. Al representar las muestras en estas dos dimensiones, las muestras más próximas entre sí, presentan una distribución de frecuencias de expresión génica similar. Para realizar esta representación se puede utilizar la siguiente función del paquete limma:\n\nplotMDS(dge): Realiza un diagrama de componentes principales de la matriz de frecuencias de la estructura de datos dge.\n\nAlternativamente, se pueden calcular los componentes principales mediante la función prcomp del paquete stats y luego usar la función autoplot del paquete ggfortify para dibujar el diagrama de componentes principales.\n\nEjemplo 1.6 A continuación se muestra cómo obtener el diagrama de componentes principales de la matriz de frecuencias de nuestro ejemplo.\n\nplotMDS(dge, col = as.numeric(dge$samples$group), main = \"Diagrama de componentes principales del logaritmo en base 2 de las frecuencias por millón\")\n\n\n\n\n\nlibrary(ggfortify)\nautoplot(prcomp(t(lcpm)), data = dge$samples, color = \"group\", loadings = F, loadings.label = F) +\nlabs(title = \"Diagrama de componentes principales del logaritmo en base 2 de las frecuencias por millón\")\n\n\n\n\nComo se puede apreciar las muestras de cada grupo experimental aparecen agrupadas. La mayor diferencia (a lo largo del primer componente principal) se da entre el grupo basal y los otros dos grupos. Esto indica que cuando se realice el análisis de expresión génica diferencial habrá bastantes genes con diferencias de expresión significativa entre el grupo basal y los otros dos, mientras que no habrá tantos al comparar los grupos LP y ML.\n\nOtra opción muy interesante es el paquete Glimma que permite dibujar un diagrama de componentes principales interactivo mediante la función\n\nglMDSPlot(lcpm): Dibuja un diagrama de componentes principales interactivo de la matriz de frecuencias lcpm.\n\n\nEjemplo 1.7 A continuación se muestra cómo obtener el diagrama de componentes principales para nuestro ejemplo con el paquete Glimma.\n\nlibrary(Glimma)\nlibrary(DESeq2)\n#glMDSPlot(lcpm, groups = dge$samples[,c(2,5)])\ndds &lt;- DESeqDataSetFromMatrix(\n  countData = dge$counts,\n  colData = dge$samples,\n  rowData = dge$genes,\n  design = ~group\n)\nglimmaMDS(dds)\n\n\n\n\n\n\n\n\n\n1.1.4 Análisis de expresión génica diferencial\nLa última etapa del análisis, y la más importante, es la detección de los genes con una expresión significativamente diferente entre los grupos experimentales. Para ello se suelen utilizar modelos lineales o modelos lineales generalizados. En general, la estimación de los parámetros del modelo ajustado depende de la distribución teórica usada para modelizar las frecuencias de expresión génica. El paquete limma, por ejemplo, realiza un ajuste de modelo lineal suponiendo que las distribuciones de las variables implicadas son normales, mientras que el paquete edgeR modeliza las frecuencias de expresión de los genes observadas mediante la distribución binomial negativa, que es mucho más realista.\nEn general en las distribuciones de frecuencias de expresión génica, se ha observado que la varianza no es independiente de la media. Los métodos que modelizan las frecuencias mediante el modelo binomial negativo asumen una relación cuadrática entre la varianza y media.\nEl siguiente paso es estimar la dispersión de las frecuencias de expresión génica para cada gen. Para ello edgeR utiliza el método de la máxima verosimilitud condicionada y ajustada por percentiles, mediante la función\n\nestimateDisp(dge, diseño): Realiza una estimación de la dispersión de las frecuencias de expresión génica contenidas en la estructura del tipo DGEList dad en dge, de acuerdo al diseño experimental dado en diseño.\n\n\nEjemplo 1.8  \n\ndge &lt;- estimateDisp(dge)\n\nUsing classic mode.\n\n\n\nUna vez ajustado el modelo Binomial Negativo y estimada la dispersión, solo queda aplicar el contraste de comparación de la expresión génica diferencial entre los grupos experimentales. Para ello edgeR utiliza el test exacto similar al test exacto de Fisher, pero adaptado a la distribución Binomial Negativa. Para ello se usa la función\n\nexacTest(dge, pair=grupos): Realiza el contraste de comparación de la expresión génica a partir del las frecuencias de aparción de genes contenidas en la estructura del tipo DGEList dada en dge, entre los grupos experimentales dados en el vector grupos (solo puede contener dos grupos).\n\n\nEjemplo 1.9 En nuestro ejemplo realizamos tres contrastes para todos los posibles pares de grupos experimentales.\n\nexact_B_LP &lt;- exactTest(dge, pair= c(\"Basal\", \"LP\"))\nexact_B_ML &lt;- exactTest(dge, pair= c(\"Basal\", \"ML\"))\nexact_LP_ML &lt;- exactTest(dge, pair= c(\"LP\", \"ML\"))\n\n\nTras realizar el contraste se puede utilizar la siguiente función para obtener un resumen con el número de genes subrexpresados y sobrexpresados significativamente.\n\nsummary(decideTests(test)): Devuelve una tabla con los genes subexpresados, sobreexpresados significativamente, así como lo que no presentan cambios significativos a partir de los resultados del contraste test.\n\nFinalmente, para ver los genes con diferencias de expresión más estadísticamente significativas se puede utilizar la función\n\ntopTags(test): Devuelve un data frame con los genes con diferencias de expresión estadísticamente más significativas entre los grupos experimentales comparados en objeto de resultados del contraste test.\n\n\nEjemplo 1.10 Resumen con los genes subexpresados y sobreexpresados significativamente entre el grupo Basal y LP.\n\nsummary(decideTests(exact_B_LP))\n\n       LP-Basal\nDown       4864\nNotSig     7203\nUp         4557\n\n\nGenes con diferencias más significativas entre el grupo Basal y el grupo LP.\n\nas.data.frame(topTags(exact_B_LP))  |&gt; \n  gt(rownames_to_stub = T, caption = \"Genes más subexpresados o sobreexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  Genes más subexpresados o sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      ENTREZID\n      SYMBOL\n      TXCHROM\n      logFC\n      logCPM\n      PValue\n      FDR\n    \n  \n  \n    67451\n67451\nPkp2\nchr16\n5.661601\n5.672839\n2.184632e-164\n3.631733e-160\n    19253\n19253\nPtpn18\nchr1\n5.588760\n5.344834\n3.519102e-160\n2.925078e-156\n    218518\n218518\nMarveld2\nchr13\n5.216899\n6.054980\n4.369286e-157\n2.421167e-153\n    50722\n50722\nDkkl1\nchr7\n6.296222\n6.098528\n6.043793e-156\n2.511800e-152\n    227960\n227960\nGca\nchr2\n5.516041\n5.060151\n6.024796e-144\n2.003124e-140\n    242505\n242505\nRasef\nchr4\n6.071991\n6.704767\n2.430700e-143\n6.734659e-140\n    320007\n320007\nSidt1\nchr16\n6.297688\n4.897542\n1.142473e-135\n2.713210e-132\n    22249\n22249\nUnc13b\nchr4\n4.343846\n6.600123\n1.313443e-134\n2.729335e-131\n    66871\n66871\nCpne8\nchr15\n-4.685486\n5.862087\n4.580752e-129\n8.461158e-126\n    269132\n269132\nColgalt2\nchr1\n-4.989659\n5.011534\n4.878508e-126\n8.110031e-123\n  \n  \n  \n\n\n\n\nResumen con los genes subexpresados y sobreexpresados significativamente entre el grupo Basal y ML.\n\nsummary(decideTests(exact_B_ML))\n\n       ML-Basal\nDown       4773\nNotSig     7011\nUp         4840\n\n\nGenes con diferencias más significativas entre el grupo Basal y el grupo ML.\n\nas.data.frame(topTags(exact_B_ML))  |&gt; \n  gt(rownames_to_stub = T, caption = \"Genes más subexpresados o sobreexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  Genes más subexpresados o sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      ENTREZID\n      SYMBOL\n      TXCHROM\n      logFC\n      logCPM\n      PValue\n      FDR\n    \n  \n  \n    50722\n50722\nDkkl1\nchr7\n6.728394\n6.098528\n4.166088e-173\n6.925705e-169\n    242505\n242505\nRasef\nchr4\n6.678297\n6.704767\n2.371625e-165\n1.971295e-161\n    21804\n21804\nTgfb1i1\nchr7\n-6.120166\n6.012779\n9.151423e-156\n5.071108e-152\n    22249\n22249\nUnc13b\nchr4\n4.561206\n6.600123\n3.599522e-150\n1.495961e-146\n    20661\n20661\nSort1\nchr3\n4.948551\n7.722875\n8.615672e-144\n2.864539e-140\n    12521\n12521\nCd82\nchr2\n4.666737\n8.007651\n8.771904e-143\n2.430402e-139\n    67451\n67451\nPkp2\nchr16\n5.100406\n5.672839\n7.763029e-140\n1.843608e-136\n    218518\n218518\nMarveld2\nchr13\n4.815118\n6.054980\n7.247449e-139\n1.506020e-135\n    78896\n78896\nEcrg4\nchr1\n-6.587115\n5.670792\n9.526597e-139\n1.759668e-135\n    214968\n214968\nSema6d\nchr2\n-5.935614\n6.101960\n1.913875e-125\n3.181626e-122\n  \n  \n  \n\n\n\n\nResumen con los genes subexpresados y sobreexpresados significativamente entre el grupo LP y ML.\n\nsummary(decideTests(exact_LP_ML))\n\n       ML-LP\nDown    2432\nNotSig 11226\nUp      2966\n\n\nGenes con diferencias más significativas entre el grupo LP y el grupo ML.\n\nas.data.frame(topTags(exact_LP_ML))  |&gt; \n  gt(rownames_to_stub = T, caption = \"Genes más subexpresados o sobreexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  Genes más subexpresados o sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      ENTREZID\n      SYMBOL\n      TXCHROM\n      logFC\n      logCPM\n      PValue\n      FDR\n    \n  \n  \n    94212\n94212\nPag1\nchr3\n-2.616277\n5.916572\n9.314994e-31\n1.548525e-26\n    214968\n214968\nSema6d\nchr2\n-2.378756\n6.101960\n3.482661e-27\n2.894788e-23\n    114479\n114479\nSlc5a5\nchr8\n2.879278\n7.770145\n1.246288e-26\n6.906100e-23\n    207592\n207592\nTbc1d16\nchr11\n2.308784\n5.659683\n6.219699e-26\n2.584907e-22\n    13617\n13617\nEdnra\nchr8\n-3.187364\n4.014091\n1.557011e-25\n5.176750e-22\n    231605\n231605\nGalnt9\nchr5\n3.289480\n2.482287\n2.766785e-24\n7.665838e-21\n    12614\n12614\nCelsr1\nchr15\n2.826770\n5.693953\n1.525133e-23\n3.621973e-20\n    14778\n14778\nGpx3\nchr11\n3.045448\n9.996423\n4.769484e-23\n9.910988e-20\n    107895\n107895\nMgat5\nchr1\n2.025411\n5.535760\n9.509983e-23\n1.756600e-19\n    320127\n320127\nDgki\nchr6\n2.415427\n4.951953\n1.261948e-22\n2.097863e-19\n  \n  \n  \n\n\n\n\n\nOtra alternativa, para diseños experimentales que incluye más de un factor, es usar modelos lineales generalizados (GLM). El primer paso es definir la matriz del diseño del experimento, que incluye las variables que definen grupos experimentales. Para ello se utiliza la función\n\nmodel.matrix(formula-diseño): Construye una matriz con el diseño experimental de acuerdo a la fórmula dada en formula-diseño. Esta fórmula es similar a la fórmula que que utiliza en un ANOVA para definir el diseño experimental, donde las variables se añaden con el operador +, y se hacen interactuar con el operador *.\n\n\nEjemplo 1.11 Continuando con el mismo ejemplo, definimos la matriz de diseño del modelo.\n\ndiseño &lt;- model.matrix(~ 0 + dge$samples$group + dge$samples$Lote)\ncolnames(diseño) &lt;- gsub(\"dge\\\\$samples\\\\$group\", \"\", colnames(diseño))\ncolnames(diseño) &lt;- gsub(\"dge\\\\$samples\\\\$\", \"\", colnames(diseño))\ndiseño\n\n  Basal LP ML LoteL006 LoteL008\n1     0  1  0        0        0\n2     0  0  1        0        0\n3     1  0  0        0        0\n4     1  0  0        1        0\n5     0  0  1        1        0\n6     0  1  0        1        0\n7     1  0  0        1        0\n8     0  0  1        0        1\n9     0  1  0        0        1\nattr(,\"assign\")\n[1] 1 1 1 2 2\nattr(,\"contrasts\")\nattr(,\"contrasts\")$`dge$samples$group`\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$`dge$samples$Lote`\n[1] \"contr.treatment\"\n\n\n\nAl igual que antes, antes de realizar el contraste hay que estimar la dispersión conjunta y para cada gen, pero ahora hay que introducir el diseño como un parámetro de la función estimateDisp.\n\nEjemplo 1.12 Realizamos la estimación de la dispersión para nuestro ejemplo.\n\ndge &lt;- estimateDisp(dge, diseño)\n\n\nUna vez estimada la dispersión y ajustados los modelos generalizados binomiales negativos, ya se puede realizar el contraste de comparación de expresión génica. Para ello se utilizan las siguientes funciones\n\nglmQLFit(dge, diseño): Realiza el ajuste del modelo generalizado de comparación de expresión génica mediante el test F de cuasi verosimilitud, con las frecuencias de expresión de la estructura del tipo DGEList dada en dge y de acuerdo al diseño experimental indicado en diseño.\nmakeContrast(grupo1 - grupo2, levels=diseño): Define los grupos grupo1 y grupo2 a comparar en el contraste pares para la diferencia en la expresión génica.\nglmQLFTest(modelo-ajustado, contrast=contraste). Realiza el contraste de comparación por pares a partir del modelo ajustado modelo-ajustado. El modelo ajustado tiene varios coeficientes dependiendo del número grupos experimentales, el primero corresponde al ajuste base para el grupo control, y los sucesivos a las diferencias de los otros grupos experimentales con el control.\nglmTreat(modelo-ajustado, contrast=contraste, lfc = n). Realiza el contraste de comparación por pares similar al de la función anterior, pero descartando los genes con un logaritmo en base dos de la razón de cambio (logFC) menor que el valor dado en el parámetro lfc.\n\n\nEjemplo 1.13 Realizamos el ajuste del modelo linear generalizado para nuestro ejemplo.\n\nmodelo &lt;- glmQLFit(dge, diseño)\n\nY, a continuación, los contrastes por pares. En primer lugar, comparamos Basal con LP y mostramos los genes más diferenciados.\n\ncontraste &lt;- makeContrasts(Basal - LP, levels = diseño) \nglmQL_B_LP &lt;- glmQLFTest(modelo, contrast = contraste)\nsummary(decideTests(glmQL_B_LP))\n\n       1*Basal -1*LP\nDown            4523\nNotSig          7192\nUp              4909\n\nas.data.frame(topTags(glmQL_B_LP))  |&gt; \n  gt(rownames_to_stub = T, caption = \"Genes más subexpresados o sobreexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  Genes más subexpresados o sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      ENTREZID\n      SYMBOL\n      TXCHROM\n      logFC\n      logCPM\n      F\n      PValue\n      FDR\n    \n  \n  \n    242505\n242505\nRasef\nchr4\n-5.941271\n6.704195\n1863.844\n5.629045e-11\n4.877025e-07\n    67451\n67451\nPkp2\nchr16\n-5.745868\n5.671932\n1845.036\n5.867451e-11\n4.877025e-07\n    19253\n19253\nPtpn18\nchr1\n-5.655466\n5.343492\n1616.133\n1.008466e-10\n5.588246e-07\n    53624\n53624\nCldn7\nchr11\n-5.527387\n7.529234\n1327.691\n2.251566e-10\n6.258841e-07\n    14275\n14275\nFolr1\nchr7\n-6.925474\n5.510509\n1313.864\n2.349910e-10\n6.258841e-07\n    218518\n218518\nMarveld2\nchr13\n-5.153654\n6.054055\n1300.770\n2.448002e-10\n6.258841e-07\n    70350\n70350\nBasp1\nchr15\n-6.086771\n6.624263\n1223.255\n3.145873e-10\n6.258841e-07\n    228543\n228543\nRhov\nchr2\n-6.263337\n6.939962\n1112.552\n4.632731e-10\n6.258841e-07\n    70737\n70737\nCgn\nchr3\n-5.466154\n6.644032\n1075.182\n5.325457e-10\n6.258841e-07\n    320007\n320007\nSidt1\nchr16\n-6.345681\n4.895659\n1071.587\n5.398676e-10\n6.258841e-07\n  \n  \n  \n\n\n\n\nA continuación comparamos Basal con ML.\n\ncontraste &lt;- makeContrasts(Basal - ML, levels = diseño) \nglmQL_B_ML &lt;- glmQLFTest(modelo, contrast = contraste)\nsummary(decideTests(glmQL_B_ML))\n\n       1*Basal -1*ML\nDown            4811\nNotSig          7060\nUp              4753\n\nas.data.frame(topTags(glmQL_B_ML))  |&gt; \n  gt(rownames_to_stub = T, caption = \"Genes más subexpresados o sobreexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  Genes más subexpresados o sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      ENTREZID\n      SYMBOL\n      TXCHROM\n      logFC\n      logCPM\n      F\n      PValue\n      FDR\n    \n  \n  \n    242505\n242505\nRasef\nchr4\n-6.539106\n6.704195\n2151.638\n3.128356e-11\n5.200579e-07\n    71740\n71740\nNectin4\nchr1\n-5.586420\n6.447456\n1566.715\n1.144948e-10\n6.188524e-07\n    67451\n67451\nPkp2\nchr16\n-5.178572\n5.671932\n1566.704\n1.144981e-10\n6.188524e-07\n    53624\n53624\nCldn7\nchr11\n-5.504748\n7.529234\n1333.741\n2.210153e-10\n6.188524e-07\n    78896\n78896\nEcrg4\nchr1\n6.456502\n5.672665\n1256.914\n2.815928e-10\n6.188524e-07\n    19253\n19253\nPtpn18\nchr1\n-4.594745\n5.343492\n1155.825\n3.964889e-10\n6.188524e-07\n    50722\n50722\nDkkl1\nchr7\n-6.778277\n6.097962\n1152.189\n4.016182e-10\n6.188524e-07\n    12521\n12521\nCd82\nchr2\n-4.687198\n8.007496\n1151.233\n4.029809e-10\n6.188524e-07\n    218518\n218518\nMarveld2\nchr13\n-4.755942\n6.054055\n1146.641\n4.096058e-10\n6.188524e-07\n    108153\n108153\nAdamts7\nchr9\n4.697586\n5.748726\n1135.707\n4.259335e-10\n6.188524e-07\n  \n  \n  \n\n\n\n\nY ahora comparamos LP con ML.\n\ncontraste &lt;- makeContrasts(LP - ML, levels = diseño) \nglmQL_LP_ML &lt;- glmQLFTest(modelo, contrast = contraste)\nsummary(decideTests(glmQL_LP_ML))\n\n       1*LP -1*ML\nDown         3175\nNotSig      10879\nUp           2570\n\nas.data.frame(topTags(glmQL_LP_ML))  |&gt; \n  gt(rownames_to_stub = T, caption = \"Genes más subexpresados o sobreexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  Genes más subexpresados o sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      ENTREZID\n      SYMBOL\n      TXCHROM\n      logFC\n      logCPM\n      F\n      PValue\n      FDR\n    \n  \n  \n    11815\n11815\nApod\nchr16\n4.283581\n6.321010\n486.9859\n1.330736e-08\n0.0002212215\n    20319\n20319\nSfrp2\nchr3\n2.753550\n4.598845\n314.7591\n7.723980e-08\n0.0005622194\n    15212\n15212\nHexb\nchr13\n2.909540\n5.986395\n286.4532\n1.126803e-07\n0.0005622194\n    13132\n13132\nDab2\nchr15\n2.557433\n5.184149\n271.5224\n1.395871e-07\n0.0005622194\n    14962\n14962\nCfb\nchr17\n1.803855\n4.762677\n253.8898\n1.825182e-07\n0.0005622194\n    18552\n18552\nPcsk5\nchr19\n2.158846\n4.236652\n238.4773\n2.342784e-07\n0.0005622194\n    12424\n12424\nCck\nchr9\n4.313973\n4.761400\n236.2864\n2.430493e-07\n0.0005622194\n    74365\n74365\nLonrf3\nchrX\n2.245457\n4.517287\n226.4194\n2.880104e-07\n0.0005622194\n    73341\n73341\nArhgef6\nchrX\n2.346351\n7.760006\n219.2708\n3.271778e-07\n0.0005622194\n    18858\n18858\nPmp22\nchr11\n1.724631\n5.964828\n204.3723\n4.325480e-07\n0.0005622194\n  \n  \n  \n\n\n\n\nPor último buscamos los genes con una expresión diferente en los tres grupos experimentales.\n\nglmQL_all &lt;- glmQLFTest(modelo, coef = 2:3)\nas.data.frame(topTags(glmQL_all))  |&gt; \n  gt(rownames_to_stub = T, caption = \"Genes más subexpresados o sobreexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  Genes más subexpresados o sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      ENTREZID\n      SYMBOL\n      TXCHROM\n      logFC.LP\n      logFC.ML\n      logCPM\n      F\n      PValue\n      FDR\n    \n  \n  \n    68598\n68598\nDnajc8\nchr4\n-14.75481\n-14.52690\n5.503444\n3917.603\n5.798476e-13\n3.280446e-11\n    78658\n78658\nNcapd3\nchr9\n-15.14518\n-15.10475\n5.096621\n3893.545\n5.946855e-13\n3.280446e-11\n    76251\n76251\nErcc6l2\nchr13\n-14.63388\n-14.74224\n5.220876\n3886.831\n5.989106e-13\n3.280446e-11\n    67444\n67444\nIlkap\nchr1\n-14.43347\n-14.33013\n5.399407\n3841.724\n6.282843e-13\n3.280446e-11\n    58859\n58859\nEfemp2\nchr19\n-14.80616\n-14.65589\n5.410953\n3840.347\n6.292087e-13\n3.280446e-11\n    24045\n24045\nScamp3\nchr3\n-15.06093\n-14.58439\n5.202811\n3765.952\n6.817772e-13\n3.280446e-11\n    21371\n21371\nTbca\nchr13\n-14.99664\n-15.05218\n5.185991\n3765.800\n6.818903e-13\n3.280446e-11\n    57443\n57443\nFbxo3\nchr2\n-14.01332\n-14.04999\n5.861901\n3765.551\n6.820748e-13\n3.280446e-11\n    80517\n80517\nHerpud2\nchr9\n-14.26672\n-14.05908\n5.853877\n3756.947\n6.885051e-13\n3.280446e-11\n    231464\n231464\nCnot6l\nchr5\n-14.28498\n-14.01301\n5.835142\n3750.520\n6.933572e-13\n3.280446e-11\n  \n  \n  \n\n\n\n\n\n\n\n1.1.5 Visualización de resultados\nExisten diferentes diagramas para representar los resultados del análisis génico diferencial. En esta sección presentamos dos de los diagramas más utilizados, el diagrama MD y el diagrama de volcán.\n\n1.1.5.1 Diagrama MD\nEste diagrama consiste en un mapa de puntos donde cada punto corresponde a un gen. El eje X representa la media del logaritmo de las frecuencias por millón (lcpm) y el eje Y representa el logaritmo en base 2 de la razón de cambio (logFC). Habitualmente, los genes subexpresados significativamente se dibujan en color azul, mientras que los sobreexpresados se dibujan en color rojo.\nPara dibujar un diagrama MD con edgeR se utiliza la función\n\nplotMD(contraste): Dibuja un diagrama MD a partir de los resultados del contraste de comparación de expresión génica dado en contraste.\n\n\nEjemplo 1.14 Dibujamos primero el diagrama MD para la comparación de los grupos Basal y LP.\n\nplotMD(glmQL_B_LP)\n\n\n\n\nA continuación para la comparación de los grupos Basal y ML.\n\nplotMD(glmQL_B_ML)\n\n\n\n\nY finalmente para la comparación de los grupos LP y ML.\n\nplotMD(glmQL_LP_ML)\n\n\n\n\n\n\n\n1.1.5.2 Diagrama de volcán\nUn diagrama de volcán es una representación gráfica utilizada en Bioinformática para visualizar los resultados del análisis de expresión génica diferencial u otros tipos de análisis de datos ómicos de alto rendimiento, como Proteómica o Metabolómica.\nEn un diagrama de volcán, cada punto de datos representa un gen (o una proteína/metabolito) del conjunto de datos. El eje x muestra el cambio logarítmico o tamaño del efecto, que mide la magnitud del cambio en la expresión entre dos condiciones (por ejemplo, tratamiento vs. control). El eje y muestra la significación estadística, a menudo representada como el logaritmo negativo del valor p. Un valor p más pequeño indica una mayor significación estadística.\nA menudo, los puntos en el gráfico de volcán están coloreados o resaltados según su significación estadística y cambio en la expresión. Por lo general, los genes significativamente sobreexpresados se representan en rojo, los genes significativamente subexpresados en azul y los genes no significativamente expresados en gris o negro. Cuanto más significativos sean estadísticamente y mayor sea el cambio en la expresión, más alejados estarán los puntos del centro del gráfico.\nedgR no incorpora una función para realizar este tipo de diagramas, así que utilizaremos la siguiente función del paquete Glimma\n\nglimmaVolcano(contraste, dge = dge): Realiza diagrama de volcán del contraste de comparación de expresión génica dado en contraste, realizado sobre la estructura de datos del tipo DGEList dada en dge.\n\nEn el capítulo Diagramas de Volcán se explica con más detalle su creación con el paquete ggplot2.\n\nEjemplo 1.15 Dibujamos primero el diagrama de volcán para la comparación de los grupos Basal y LP.\n\nlibrary(Glimma)\nglimmaVolcano(glmQL_B_LP, dge = dge)\n\n\n\n\n\n\nA continuación para la comparación de los grupos Basal y ML.\n\nlibrary(Glimma)\nglimmaVolcano(glmQL_B_ML, dge = dge)\n\n\n\n\n\n\nY finalmente para la comparación de los grupos LP y ML.\n\nlibrary(Glimma)\nglimmaVolcano(glmQL_LP_ML, dge = dge)"
  },
  {
    "objectID": "01-rna-seq.html#análisis-de-expresión-génica-diferencial-con-deseq2",
    "href": "01-rna-seq.html#análisis-de-expresión-génica-diferencial-con-deseq2",
    "title": "1  Análisis de expresión génica diferencial (RNA-Seq)",
    "section": "1.2 Análisis de expresión génica diferencial con DESeq2",
    "text": "1.2 Análisis de expresión génica diferencial con DESeq2\nEl paquete DESeq2 es otro de los paquetes más utilizados para el análisis de la expresión génica diferencial, que al igual que edgeR incorpora procedimientos para todas las etapas del análisis. También está disponible en el repositorio Bioconductor.\n\n1.2.1 Estructura de Datos\nEl paquete DESeq2 utiliza la estructura de datos DESeqDataSet para guardar la matriz de frecuencias de expresión génica. Esta estructura se deriva, a su vez, de la estructura SingleCellExperiment, que además de la matriz de frecuencias de expresión de los genes incluye también los grupos experimentales a los que pertenecen las muestras estudiadas y otra información que se va generando a medida que progresa el análisis.\n\n\n\nEl objeto SingleCellExperiment\n\n\nEl paquete SingleCellExperiment de Bioconductor define esta estructura de datos, y puede instalarse mediante el siguiente código\nBiocManager::install('SingleCellExperiment')\nPara crear la estructura de datos DESeqDataSet se utiliza la siguiente función\n\nDESeqDataSetFromMatrix(countData = frec, colData = grupo, design = diseño): Crea una estructura del tipo DESeqDataSet con la matriz de frecuencias de expresión génica frec (con genes en filas y muestras en columnas), y el data frame grupo con los grupos experimentales a los que pertenecen las muestras analizadas en las columnas de la matriz de frecuencias y la columna diseño del data frame grupo que contiene los grupos experimentales a comparar.\n\n\nEjemplo 1.16 Siguiendo con el mismo ejemplo de la sección anterior, podemos aprovechar la estructura de datos DGEList creada durante el análisis génico diferencial con el paquete edgeR para crear a partir de ella la estructura de datos DESeqDataSet que requiere el paquete DESeq2.\n\nlibrary(DESeq2)\ndds &lt;- DESeqDataSetFromMatrix(\n  countData = frecuencias,\n  colData = muestras,\n  rowData = genes,\n  design = ~ Grupo\n)\n\nWarning in DESeqDataSet(se, design = design, ignoreRank): some variables in\ndesign formula are characters, converting to factors\n\ndds\n\nclass: DESeqDataSet \ndim: 27179 9 \nmetadata(1): version\nassays(1): counts\nrownames(27179): 497097 100503874 ... 100861691 100504472\nrowData names(3): ENTREZID SYMBOL TXCHROM\ncolnames(9): LP1 ML1 ... ML3 LP3\ncolData names(3): Id Grupo Lote\n\n\n\nSi disponemos de los datos en el formato de la estructura de datos DGEList, es fácil convertirlos al formato de la estructura de datos DESeqDataSet mediante la función as.DESeqDataSet del paquete DEFormats.\n\nas.DESeqDataSet(dge): Devuelve una estructura de datos del tipo DESeqDataSet con los datos de la estructura de datos DGEList dada en dge.\n\n\nEjemplo 1.17  \nlibrary(DEFormats)\ndds &lt;- as.DESeqDataSet(dge)\n\nUna vez creada la estructura de datos, podemos acceder a la información que contiene con las siguientes funciones:\n\ncounts(dds): Devuelve un data frame con las frecuencias de expresión génica de la estructura de datos en formato DESEqDataSet dada en dds.\ncolData(dds): Devuelve un data frame con la información de las muestras (columnas) de la estructura de datos en formato DESEqDataSet dada en dds.\nrowData(dds): Devuelve un data frame con la información de los genes (filas) de la estructura de datos en formato DESEqDataSet dada en dds.\ndesign(dds): Devuelve la fórmula del diseño experimental de la estructura de datos en formato DESEqDataSet dada en dds.\n\n\nEjemplo 1.18 Para comprobar que se creado bien la estructura de datos, mostramos la información que contiene. Primero la matriz de frecuencias de expresión génica.\n\nhead(counts(dds))\n\n          LP1 ML1   B1   B2  ML2 LP2  B3 ML3 LP3\n497097      1   2  342  526    3   3 535   2   0\n100503874   0   0    5    6    0   0   5   0   0\n100038431   0   0    0    0    0   0   1   0   0\n19888       0   1    0    0   17   2   0   1   0\n20671       1   1   76   40   33  14  98  18   8\n27395     431 771 1368 1268 1564 769 818 468 342\n\n\nDespués, la información de las muestras del ejemplo.\n\ncolData(dds)\n\nDataFrame with 9 rows and 3 columns\n             Id    Grupo        Lote\n    &lt;character&gt; &lt;factor&gt; &lt;character&gt;\nLP1         LP1    LP           L004\nML1         ML1    ML           L004\nB1           B1    Basal        L004\nB2           B2    Basal        L006\nML2         ML2    ML           L006\nLP2         LP2    LP           L006\nB3           B3    Basal        L006\nML3         ML3    ML           L008\nLP3         LP3    LP           L008\n\n\nA continuación, mostramos la información de los genes.\n\nrowData(dds)\n\nDataFrame with 27179 rows and 3 columns\n             ENTREZID       SYMBOL     TXCHROM\n          &lt;character&gt;  &lt;character&gt; &lt;character&gt;\n497097         497097         Xkr4        chr1\n100503874   100503874      Gm19938          NA\n100038431   100038431      Gm10568          NA\n19888           19888          Rp1        chr1\n20671           20671        Sox17        chr1\n...               ...          ...         ...\n100861837   100861837           NA          NA\n100861924   100861924           NA          NA\n170942         170942       Erdr1x        chrY\n100861691   100861691 LOC100861691          NA\n100504472   100504472           NA          NA\n\n\nY finalmente mostramos el diseño.\n\ndesign(dds)\n\n~Grupo\n\n\n\n\n\n1.2.2 Preprocesamiento\nEl paquete DESeq2 realiza el preprocesamiento de maneare automática cuando se lanza el procedimiento para el análisis de expresión génica diferencial.\n\n\n1.2.3 Análisis exploratorio\n\n\n1.2.4 Escalado multidimensional\nAl igual que antes, el principal análisis exploratorio es el escalado multidimensional. Para realizarlo podemos usar de nuevo la siguiente función del paquete Glimma.\n\nglimmaMDS(dds): Realiza un diagrama interactivo de componenetes principales a partir de la estructura de datos dds.\n\n\nEjemplo 1.19 A continuación se muestra cómo obtener el diagrama de componentes principales para nuestro ejemplo con el paquete Glimma.\n\nlibrary(Glimma)\nglimmaMDS(dds)\n\n\n\n\n\n\n\n\n1.2.5 Análisis de expresión génica diferencial\nPara realizar el análisis de expresión génica diferencial el paquete DESeq2 utiliza la siguiente función\n\nDESeq(dds): Realiza el preprocesamiento de datos y el ajuste del modelo para el análisis de expresión génica diferencial de la estructura de datos en formato DESeqDataSet dada en dds.\n\nAntes de proceder con el análisis es importante definir la categoría de referencia (grupo control) como el primer nivel del principal factor experimental. Ya que el cálculo de los estadísticos como el logaritmo en base 2 de la razón de cambio (logFC) se realizará con respecto a esta categoría.\nPara visualizar los resultados de análisis de expresión génica diferencial se utilizan las funciones\n\nresults(dds, contrast = c(factor, grupo1, grupo2), alpha = 0.05): Muestra una tabla con los principales estadísticos del contraste de comparación de expresión génica del grupo2 frente al grupo1 del factor experimental dado en factor, realizado a partir de la estructura de datos en formato DESeqDataSet dada en dds. Si no se indica el parámetro contrast, por defecto se muestra el resultado del contraste de comparación del último nivel del factor experimental frente al primero. El parámetro alpha indica el nivel de significación del contraste, des decir, probabilidad por debajo de la cuál se considera significativo el p-valor ajustado.\nsummary(contraste): Devuelve un resumen con los genes subexpresados y sobreexpresados significativamente a partir de los resultados del contraste de comparación de expresión génica dados en contraste.\n\n\nEjemplo 1.20 Siguiendo con nuestro ejemplo, primero definiremos el grupo Basal como la primera categoría del factor group.\n\ndds$Grupo &lt;- relevel(dds$Grupo, \"Basal\")\n\nA continuación ya podemos realizar el análisis de expresión génica diferencial para nuestro ejemplo.\n\ndds &lt;- DESeq(dds)\n\nestimating size factors\n\n\nestimating dispersions\n\n\ngene-wise dispersion estimates\n\n\nmean-dispersion relationship\n\n\nfinal dispersion estimates\n\n\nfitting model and testing\n\ndds\n\nclass: DESeqDataSet \ndim: 27179 9 \nmetadata(1): version\nassays(4): counts mu H cooks\nrownames(27179): 497097 100503874 ... 100861691 100504472\nrowData names(29): ENTREZID SYMBOL ... deviance maxCooks\ncolnames(9): LP1 ML1 ... ML3 LP3\ncolData names(4): Id Grupo Lote sizeFactor\n\n\nA continuación, mostramos los resultados para la comparación del grupo Basal con el grupo LP.\n\nres_B_LP &lt;- results(dds, contrast = c(\"Grupo\", \"Basal\", \"LP\"))\n# Resumen de genes subexpresados y sobreexpresados.\nsummary(res_B_LP)\n\n\nout of 22026 with nonzero total read count\nadjusted p-value &lt; 0.1\nLFC &gt; 0 (up)       : 5494, 25%\nLFC &lt; 0 (down)     : 5264, 24%\noutliers [1]       : 18, 0.082%\nlow counts [2]     : 2953, 13%\n(mean count &lt; 1)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n# Genes subexpresados significativamente ordenados de menor a mayor logFC.\nas.data.frame(res_B_LP)  |&gt; \n  filter(log2FoldChange &lt; 0 & padj &lt; 0.05) |&gt;\n  arrange(log2FoldChange)  |&gt; \n  head(10) |&gt; \n  gt(rownames_to_stub = T, caption = \"10 genes más subexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  10 genes más subexpresados signiticativamente\n  \n    \n    \n      Gen\n      baseMean\n      log2FoldChange\n      lfcSE\n      stat\n      pvalue\n      padj\n    \n  \n  \n    243874\n49.26108\n-8.965084\n1.2704518\n-7.056611\n1.706126e-12\n1.262043e-11\n    347708\n243.18931\n-8.453980\n1.0758631\n-7.857858\n3.907565e-15\n3.540592e-14\n    18768\n302.95524\n-8.283820\n0.5738121\n-14.436467\n3.050847e-47\n1.234265e-45\n    68891\n85.08457\n-8.240424\n0.9295045\n-8.865394\n7.623421e-19\n8.682862e-18\n    545847\n73.96691\n-8.120701\n0.9030947\n-8.992082\n2.425908e-19\n2.856963e-18\n    20750\n138304.22680\n-8.046167\n0.4702365\n-17.110896\n1.230909e-65\n1.037831e-63\n    230405\n23.02081\n-7.939209\n1.2914113\n-6.147700\n7.861447e-10\n4.715136e-09\n    17830\n29.79799\n-7.915517\n1.3274643\n-5.962885\n2.478234e-09\n1.412586e-08\n    237749\n40.12100\n-7.847820\n1.2804673\n-6.128871\n8.850462e-10\n5.283382e-09\n    16415\n15.09905\n-7.834211\n1.2996894\n-6.027757\n1.662512e-09\n9.673028e-09\n  \n  \n  \n\n\n\n# Genes sobrexpresados significativamente ordenados de mayor a menor logFC.\nas.data.frame(res_B_LP)  |&gt; \n  filter(log2FoldChange &gt; 0 & padj &lt; 0.05) |&gt;\n  arrange(desc(log2FoldChange))  |&gt; \n  head(10) |&gt; \n  gt(rownames_to_stub = T, caption = \"10 genes más sobreexpresados signiticativamente\")   |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  10 genes más sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      baseMean\n      log2FoldChange\n      lfcSE\n      stat\n      pvalue\n      padj\n    \n  \n  \n    624245\n130.01315\n10.651813\n1.2050616\n8.839227\n9.638348e-19\n1.092556e-17\n    360220\n91.29897\n9.185650\n1.1765135\n7.807518\n5.832527e-15\n5.203127e-14\n    100861621\n152.72891\n9.143254\n1.0158933\n9.000211\n2.252843e-19\n2.656431e-18\n    74720\n31.74058\n8.621050\n1.3331640\n6.466608\n1.002270e-10\n6.480572e-10\n    224065\n31.39369\n8.603568\n1.2600963\n6.827706\n8.628293e-12\n6.051237e-11\n    22409\n1408.83897\n8.488714\n0.4741240\n17.903996\n1.097572e-71\n1.130499e-69\n    26950\n297.03582\n8.157546\n1.5000622\n5.438138\n5.384013e-08\n2.687071e-07\n    100861755\n228.37922\n7.958092\n0.6120430\n13.002505\n1.184006e-38\n3.444462e-37\n    23964\n4653.79258\n7.941830\n0.4989370\n15.917500\n4.791431e-57\n2.880149e-55\n    223838\n501.88062\n7.843173\n0.4330005\n18.113540\n2.491951e-73\n2.728972e-71\n  \n  \n  \n\n\n\n\nDespués, mostramos los resultados para la comparación del grupo Basal con el grupo ML.\n\nres_B_ML &lt;- results(dds, contrast = c(\"Grupo\", \"Basal\", \"ML\"))\n# Resumen de genes subexpresados y sobreexpresados.\nsummary(res_B_ML)\n\n\nout of 22026 with nonzero total read count\nadjusted p-value &lt; 0.1\nLFC &gt; 0 (up)       : 5618, 26%\nLFC &lt; 0 (down)     : 5402, 25%\noutliers [1]       : 18, 0.082%\nlow counts [2]     : 2953, 13%\n(mean count &lt; 1)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n# Genes subexpresados significativamente ordenados de menor a mayor logFC.\nas.data.frame(res_B_LP)  |&gt; \n  filter(log2FoldChange &lt; 0 & padj &lt; 0.05) |&gt;\n  arrange(log2FoldChange)  |&gt; \n  head(10) |&gt; \n  gt(rownames_to_stub = T, caption = \"10 genes más subexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  10 genes más subexpresados signiticativamente\n  \n    \n    \n      Gen\n      baseMean\n      log2FoldChange\n      lfcSE\n      stat\n      pvalue\n      padj\n    \n  \n  \n    243874\n49.26108\n-8.965084\n1.2704518\n-7.056611\n1.706126e-12\n1.262043e-11\n    347708\n243.18931\n-8.453980\n1.0758631\n-7.857858\n3.907565e-15\n3.540592e-14\n    18768\n302.95524\n-8.283820\n0.5738121\n-14.436467\n3.050847e-47\n1.234265e-45\n    68891\n85.08457\n-8.240424\n0.9295045\n-8.865394\n7.623421e-19\n8.682862e-18\n    545847\n73.96691\n-8.120701\n0.9030947\n-8.992082\n2.425908e-19\n2.856963e-18\n    20750\n138304.22680\n-8.046167\n0.4702365\n-17.110896\n1.230909e-65\n1.037831e-63\n    230405\n23.02081\n-7.939209\n1.2914113\n-6.147700\n7.861447e-10\n4.715136e-09\n    17830\n29.79799\n-7.915517\n1.3274643\n-5.962885\n2.478234e-09\n1.412586e-08\n    237749\n40.12100\n-7.847820\n1.2804673\n-6.128871\n8.850462e-10\n5.283382e-09\n    16415\n15.09905\n-7.834211\n1.2996894\n-6.027757\n1.662512e-09\n9.673028e-09\n  \n  \n  \n\n\n\n# Genes sobrexpresados significativamente ordenados de mayor a menor logFC.\nas.data.frame(res_B_LP)  |&gt; \n  filter(log2FoldChange &gt; 0 & padj &lt; 0.05) |&gt;\n  arrange(desc(log2FoldChange))  |&gt; \n  head(10) |&gt; \n  gt(rownames_to_stub = T, caption = \"10 genes más sobreexpresados signiticativamente\") |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  10 genes más sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      baseMean\n      log2FoldChange\n      lfcSE\n      stat\n      pvalue\n      padj\n    \n  \n  \n    624245\n130.01315\n10.651813\n1.2050616\n8.839227\n9.638348e-19\n1.092556e-17\n    360220\n91.29897\n9.185650\n1.1765135\n7.807518\n5.832527e-15\n5.203127e-14\n    100861621\n152.72891\n9.143254\n1.0158933\n9.000211\n2.252843e-19\n2.656431e-18\n    74720\n31.74058\n8.621050\n1.3331640\n6.466608\n1.002270e-10\n6.480572e-10\n    224065\n31.39369\n8.603568\n1.2600963\n6.827706\n8.628293e-12\n6.051237e-11\n    22409\n1408.83897\n8.488714\n0.4741240\n17.903996\n1.097572e-71\n1.130499e-69\n    26950\n297.03582\n8.157546\n1.5000622\n5.438138\n5.384013e-08\n2.687071e-07\n    100861755\n228.37922\n7.958092\n0.6120430\n13.002505\n1.184006e-38\n3.444462e-37\n    23964\n4653.79258\n7.941830\n0.4989370\n15.917500\n4.791431e-57\n2.880149e-55\n    223838\n501.88062\n7.843173\n0.4330005\n18.113540\n2.491951e-73\n2.728972e-71\n  \n  \n  \n\n\n\n\nY finalmente mostramos los resultados para la comparación del grupo LP con el grupo ML.\n\nres_LP_ML &lt;- results(dds, contrast = c(\"Grupo\", \"LP\", \"ML\"))\n# Resumen de genes subexpresados y sobreexpresados.\nsummary(res_LP_ML)\n\n\nout of 22026 with nonzero total read count\nadjusted p-value &lt; 0.1\nLFC &gt; 0 (up)       : 3268, 15%\nLFC &lt; 0 (down)     : 3471, 16%\noutliers [1]       : 18, 0.082%\nlow counts [2]     : 3796, 17%\n(mean count &lt; 2)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n# Genes subexpresados significativamente ordenados de menor a mayor logFC.\nas.data.frame(res_LP_ML)  |&gt; \n  filter(log2FoldChange &lt; 0 & padj &lt; 0.05) |&gt;\n  arrange(log2FoldChange)  |&gt; \n  head(10) |&gt; \n  gt(rownames_to_stub = T, caption = \"10 genes más subexpresados signiticativamente\")  |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  10 genes más subexpresados signiticativamente\n  \n    \n    \n      Gen\n      baseMean\n      log2FoldChange\n      lfcSE\n      stat\n      pvalue\n      padj\n    \n  \n  \n    16675\n35.256494\n-6.365421\n2.054093\n-3.098895\n1.942436e-03\n0.0092244161\n    70843\n73.553279\n-6.295554\n1.593891\n-3.949803\n7.821551e-05\n0.0006064116\n    116746\n10.174747\n-5.880935\n1.945496\n-3.022846\n2.504096e-03\n0.0113813883\n    20423\n4.821526\n-5.569531\n1.664008\n-3.347058\n8.167400e-04\n0.0045238652\n    13392\n38.113342\n-5.423817\n1.826760\n-2.969090\n2.986827e-03\n0.0130980234\n    22415\n7.388444\n-5.378074\n1.853749\n-2.901187\n3.717518e-03\n0.0156975269\n    319180\n6.635441\n-5.256345\n1.599572\n-3.286094\n1.015873e-03\n0.0054160042\n    19293\n5.787450\n-5.185556\n1.477070\n-3.510703\n4.469229e-04\n0.0027095072\n    13190\n6.282620\n-5.102299\n2.006739\n-2.542582\n1.100367e-02\n0.0382542306\n    242627\n5.890588\n-5.038786\n1.904499\n-2.645727\n8.151545e-03\n0.0299185702\n  \n  \n  \n\n\n\n# Genes sobrexpresados significativamente ordenados de mayor a menor logFC.\nas.data.frame(res_LP_ML)  |&gt; \n  filter(log2FoldChange &gt; 0 & padj &lt; 0.05) |&gt;\n  arrange(desc(log2FoldChange))  |&gt; \n  head(10) |&gt; \n  gt(rownames_to_stub = T, caption = \"10 genes más sobreexpresados signiticativamente\") |&gt; \n  tab_stubhead(label = \"Gen\")\n\n\n\n\n\n  10 genes más sobreexpresados signiticativamente\n  \n    \n    \n      Gen\n      baseMean\n      log2FoldChange\n      lfcSE\n      stat\n      pvalue\n      padj\n    \n  \n  \n    81906\n5.084982e+00\n6.349445\n1.5596581\n4.071049\n4.680186e-05\n3.900940e-04\n    83563\n8.780151e+00\n5.599738\n1.7943674\n3.120731\n1.804026e-03\n8.696378e-03\n    75556\n2.880224e+00\n5.504546\n1.8676200\n2.947359\n3.205013e-03\n1.389755e-02\n    67719\n8.400270e+00\n4.993597\n1.2677240\n3.939025\n8.181335e-05\n6.297484e-04\n    347708\n2.431893e+02\n4.966281\n0.9673189\n5.134068\n2.835461e-07\n4.451674e-06\n    245446\n1.262976e+02\n4.750196\n0.4521869\n10.504939\n8.197556e-26\n1.492939e-22\n    100470\n2.577426e+03\n4.594474\n1.1793063\n3.895912\n9.782983e-05\n7.365345e-04\n    12993\n3.527468e+04\n4.581113\n1.1971312\n3.826742\n1.298503e-04\n9.373102e-04\n    20750\n1.383042e+05\n4.541280\n0.4699195\n9.663952\n4.289877e-22\n2.441476e-19\n    14395\n3.024909e+00\n4.528923\n1.5358977\n2.948714\n3.190989e-03\n1.384663e-02\n  \n  \n  \n\n\n\n\n\n\n\n1.2.6 Visualización de datos\n\n1.2.6.1 Diagrama MD\nEste diagrama consiste en un mapa de puntos donde cada punto corresponde a un gen. El eje X representa la media del logaritmo de las frecuencias por millón (lcpm) y el eje Y representa el logaritmo en base 2 de la razón de cambio (logFC). Habitualmente, los genes subexpresados significativamente se dibujan en color azul, mientras que los sobreexpresados se dibujan en color rojo.\nDESeq2 no incorpora una función para realizar este tipo de diagramas, así que utilizaremos la siguiente función del paquete Glimma\n\nglimmaMA(dds, groups = factor): Realiza diagrama MD del contraste de comparación de expresión génica realizado sobre la estructura de datos del tipo DESeqDataSet dada en dds, con los grupos experimentales definidos en factor.\n\n\n\n\n\n\n\nAdvertencia\n\n\n\nLa función glimmaMA muestra el diagrama de comparación para la comparación del último nivel del factor experimental con el primero. Si tenemos más de dos grupos experimentales hay que filtrar previamente la estructura de datos en formato DESeqDataSet para que solo incluya los dos grupos a comparar.\n\n\n\nEjemplo 1.21  \n\nglimmaMA(dds, groups = dds$Grupo)\n\n8124 of 27179 genes were filtered out in DESeq2 tests\n\n\n\n\n\n\n\n\n\n\n1.2.6.2 Diagrama de volcán\nUn diagrama de volcán es una representación gráfica utilizada en Bioinformática para visualizar los resultados del análisis de expresión génica diferencial u otros tipos de análisis de datos ómicos de alto rendimiento, como Proteómica o Metabolómica.\nEn un diagrama de volcán, cada punto de datos representa un gen (o una proteína/metabolito) del conjunto de datos. El eje x muestra el cambio logarítmico o tamaño del efecto, que mide la magnitud del cambio en la expresión entre dos condiciones (por ejemplo, tratamiento vs. control). El eje y muestra la significación estadística, a menudo representada como el logaritmo negativo del valor p. Un valor p más pequeño indica una mayor significación estadística.\nA menudo, los puntos en el gráfico de volcán están coloreados o resaltados según su significación estadística y cambio en la expresión. Por lo general, los genes significativamente sobreexpresados se representan en rojo, los genes significativamente subexpresados en azul y los genes no significativamente expresados en gris o negro. Cuanto más significativos sean estadísticamente y mayor sea el cambio en la expresión, más alejados estarán los puntos del centro del gráfico.\nDESeq2 no incorpora una función para realizar este tipo de diagramas, pero podemos usar la siguiente función del paquete Glimma\n\nglimmaVolcano(dds, groups = factor): Realiza diagrama de volcán del contraste de comparación de expresión génica realizado sobre la estructura de datos del tipo DESeqDataSet dada en dds, con los grupos experimentales definidos en factor.\n\n\n\n\n\n\n\nAdvertencia\n\n\n\nLa función glimmaVolcano muestra el diagrama de comparación para la comparación del último nivel del factor experimental con el primero. Si tenemos más de dos grupos experimentales hay que filtrar previamente la estructura de datos en formato DESeqDataSet para que solo incluya los dos grupos a comparar.\n\n\nEn el capítulo Diagramas de Volcán se explica con más detalle su creación con el paquete ggplot2.\n\nEjemplo 1.22 Dibujamos el diagrama de volcán interactivo.\n\nglimmaVolcano(dds, groups = dds$Grupo)\n\n\n\n\n\n\nObsérvese que este diagrama solo muestra la comparación del último grupo experimental (ML) con respecto al grupo de referencia (Basal).\nA continuación creamos los diagrams de volcán para todos los contrastes por pares, mediante el paquete ggplot. En primer lugar para la comparación de LP frente a Basal.\n\n# Crear nueva columna con categorías de expresión génica.\ndiagramaVolcan &lt;- function(contraste, alpha = 0.05, minlogFC = 2){\n  colores &lt;- c(\"dodgerblue3\", \"gray50\", \"firebrick3\")\n  df &lt;- as.data.frame(contraste)  |&gt; na.omit()\n  rangex &lt;- max(-min(df$log2FoldChange, na.rm = T), max(df$log2FoldChange, na.rm = T))\n  maxy &lt;- max(-log10(df$padj), na.rm = T)\n  vplot &lt;- df |&gt;\n      mutate(Expresión = case_when(\n          log2FoldChange &gt;= log2(minlogFC) & padj &lt;= alpha ~ \"Up\", \n          log2FoldChange &lt;= log2(1/minlogFC) & padj &lt;= alpha ~ \"Down\",\n          TRUE ~ \"NC\"))  |&gt; \n  # Definimos los colores para los genes subexpresados, normales y sobreexpresados.\n    ggplot(aes(x = log2FoldChange, y = -log10(padj))) + \n    geom_point(aes(color = Expresión)) +\n    scale_color_manual(values = colores) +\n    # Añadimos las líneas de la razón de cambio.\n    geom_vline(xintercept = c(log2(1/minlogFC), log2(minlogFC)), linetype = \"dashed\") +\n    # Etiquetamos las líneas de la razón de cambio.\n    annotate(\"text\", x = log2(1/minlogFC), y = maxy, label = paste0(\"FC=1/\", minlogFC), vjust = 0) +\n    annotate(\"text\", x = log2(2), y = maxy, label = paste0(\"FC=\", minlogFC), vjust = 0) +\n    # Añadimos las líneas de los p-valores.\n    geom_hline(yintercept = -log10(alpha), linetype = \"dashed\") +\n    # Etiquetamos las líneas de los p-valores.\n    annotate(\"text\", x = rangex+0.1, y = -log10(alpha), label = paste0(\"p=\", alpha), hjust = 0) +\n    theme(plot.margin = unit(c(2, 1, 1, 1), \"lines\")) +\n    coord_cartesian(xlim = c(-rangex, rangex), ylim = c(0, maxy), expand = FALSE, clip = \"off\")\n  return(vplot)\n}\n\n\ndiagramaVolcan(res_B_LP, alpha = 0.05, minlogFC = 2)\n\n\n\n\nA continuación dibujamos el diagrama de volcán de ML frente a Basal.\n\ndiagramaVolcan(res_B_ML, alpha = 0.05, minlogFC = 2)\n\n\n\n\nY finalmente el diagrama de volcán de ML frente a LP.\n\ndiagramaVolcan(res_LP_ML, alpha = 0.05, minlogFC = 2)"
  },
  {
    "objectID": "01-rna-seq.html#referencias",
    "href": "01-rna-seq.html#referencias",
    "title": "1  Análisis de expresión génica diferencial (RNA-Seq)",
    "section": "1.3 Referencias",
    "text": "1.3 Referencias\n\nOrchestrating Single-Cell Analysis with Bioconductor. (s. f.). Recuperado 12 de junio de 2023, de https://github.com/LTLA/OSCA\nLaw, Charity, et al. RNA-seq analysis is easy as 1-2-3 with limma, Glimma and edgeR."
  },
  {
    "objectID": "diagrama-volcan.html",
    "href": "diagrama-volcan.html",
    "title": "2  Diagramas de volcán",
    "section": "",
    "text": "Un diagrama de volcán es una representación gráfica utilizada en Bioinformática para visualizar los resultados del análisis de expresión génica diferencial u otros tipos de análisis de datos ómicos de alto rendimiento, como Proteómica o Metabolómica.\nEn un diagrama de volcán, cada punto de datos representa un gen (o una proteína/metabolito) del conjunto de datos. El eje x muestra el cambio logarítmico o tamaño del efecto, que mide la magnitud del cambio en la expresión entre dos condiciones (por ejemplo, tratamiento vs. control). El eje y muestra la significación estadística, a menudo representada como el logaritmo negativo del valor p. Un valor p más pequeño indica una mayor significación estadística.\nA menudo, los puntos en el gráfico de volcán están coloreados o resaltados según su significación estadística y cambio en la expresión. Por lo general, los genes significativamente sobreexpresados se representan en rojo, los genes significativamente subexpresados en azul y los genes no significativamente expresados en gris o negro. Cuanto más significativos sean estadísticamente y mayor sea el cambio en la expresión, más alejados estarán los puntos del centro del gráfico.\nEl nombre del del diagrama proviene de su forma característica, donde los genes significativos con grandes cambios en la expresión se representan como puntos alejados del centro, asemejándose a las laderas de un volcán. Mientras tanto, los genes no significativos se agrupan cerca del centro, formando la caldera del volcán.\nLos investigadores utilizan gráficos de volcán para identificar rápidamente genes o proteínas con cambios sustanciales en la expresión entre condiciones y, al mismo tiempo, considerar su significación estadística. Esta visualización ayuda a identificar posibles biomarcadores, genes diferencialmente expresados o vías biológicas relevantes asociadas con condiciones o tratamientos específicos.\nEn esta sección veremos con construir un diagrama de volcán con R.\n\n\n\n\n\n\nDatos\n\n\n\nUtilizaremos los datos del estudio Fu et al. Nat Cell Biol. 2015, que contienen los resultados del análisis de expresión génica diferencial (logaritmo en base 2 de la razón de cambio y p-valor) de un estudio para comparar dos grupos experimentales.\n\n\n\n# Carga de datos\ndf &lt;- read_csv(\"datos/datos-volcan.csv\")\nhead(df)\n\n# A tibble: 6 × 8\n  ENTREZID SYMBOL  GENENAME               logFC AveExpr     t  P.Value adj.P.Val\n     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1    12992 Csn1s2b casein alpha s2-like B -8.60   3.56  -43.8 3.83e-15  6.05e-11\n2    13358 Slc25a1 solute carrier family… -4.12   5.78  -29.9 1.76e-13  1.39e- 9\n3    11941 Atp2b2  ATPase, Ca++ transpor… -7.39   1.28  -27.8 4.84e-13  2.43e- 9\n4    20531 Slc34a2 solute carrier family… -4.18   4.28  -27.1 6.16e-13  2.43e- 9\n5   100705 Acacb   acetyl-Coenzyme A car… -4.31   4.44  -25.2 1.50e-12  4.74e- 9\n6    13645 Egf     epidermal growth fact… -5.36   0.736 -24.6 2.12e-12  5.57e- 9\n\n\n\n# Creación del diagrama de volcán\nvplot &lt;- df %&gt;%\n  ggplot(aes(x = logFC, y = -log10(adj.P.Val))) + \n  geom_point(color = \"grey40\")\nvplot\n\n\n\n\nPara diferenciar los genes con mayor expresión diferencial, es decir, con mayor razón de cambio, se suelen añadir dos rectas verticales. La recta más a la izquierda representa el logaritmo en base 2 de la máxima razón de cambio para considerar un gen subexpresado (suele tomarse una razón de cambio 1/2, es decir, el gen en el grupo experimental se expresa la mitad que en el grupo control), mientras que la recta de la derecha representa el logaritmo en base 2 de la mínima razón de cambio para considerar un gen sobreexpresado (suele tomarse una razón de cambio 2, es decir, el gen en el grupo experimental se expresa el doble que en el grupo control).\n\n# Determinamos las coordenadas mínimas y máximas para las escalas de los ejes.\nrangex &lt;- max(-min(df$logFC), max(df$logFC))\nmaxy &lt;- max(-log10(df$adj.P.Val))\n# Dibujo de líneas verticales para el tamaño del efecto\nvplot &lt;- vplot + geom_vline(xintercept = c(log2(0.5), log2(2)),linetype = \"dashed\") +\n  # Etiquetamos las líneas de la razón de cambio.\n  annotate(\"text\", x = log2(0.5), y = maxy, label = \"FC=1/2\", vjust = 0) +\n  annotate(\"text\", x = log2(2), y = maxy, label = \"FC=2\", vjust = 0) +\n  theme(plot.margin = unit(c(3, 4, 1, 1), \"lines\")) +\n  coord_cartesian(xlim = c(-rangex, rangex), ylim = c(0, maxy), expand = FALSE, clip = \"off\") \nvplot\n\n\n\n\nDel mismo modo, se suelen dibujar líneas verticales para identificar los genes con una expresión diferencial estadísticamente significativa (p-valor menor que 0.05 o 0.01).\n\nvplot &lt;- vplot +\n  geom_hline(yintercept = c(-log10(0.05), -log10(0.01)), linetype = \"dashed\") +\n  # Etiquetamos las líneas de los p-valores\n  annotate(\"text\", x = 10.2, y = -log10(0.05), label = \"p=0.05\", hjust = 0) +\n  annotate(\"text\", x = 10.2, y = -log10(0.01), label = \"p=0.01\", hjust = 0) \nvplot\n\n\n\n\nPara destacar los genes con mayor expresión diferencial y mayor significación estadística, es habitual dibujarlos con un color diferenciado (típicamente azul para los subexpresados y rojo para los sobre expresados). Para ello, previamente hay que crear una nueva columna en el conjunto de datos con las categorías categorías de expresión(normalmente “Down” para los genes subexpresados significativamente, “NS” para los genes que no cambian y “Up” para los genes sobreexpresados significativamente)\n\n# Crear nueva columna con categorías de expresión génica.\ndf &lt;- df |&gt;\n    mutate(Expresión = case_when(\n        logFC &gt;= log2(2) & adj.P.Val &lt;= 0.05 ~ \"Up\", \n        logFC &lt;= log2(0.5) & adj.P.Val &lt;= 0.05 ~ \"Down\",\n        TRUE ~ \"NC\"))\n# Mostrar tabla con frecuencias de genes subexpresados y sobreexpresados\ndf  |&gt; \n    count(Expresión)  |&gt; \n    gt()\n\n\n\n\n\n  \n    \n    \n      Expresión\n      n\n    \n  \n  \n    Down\n1245\n    NC\n13578\n    Up\n981\n  \n  \n  \n\n\n\n\n\n# Definimos los colores para los genes subexpresados, normales y sobreexpresados.\ncolores &lt;- c(\"dodgerblue3\", \"gray50\", \"firebrick3\")\nvplot &lt;- df %&gt;%\n  ggplot(aes(x = logFC, y = -log10(adj.P.Val))) + \n  geom_point(aes(color = Expresión)) +\n  scale_color_manual(values = colores) +\n  # Añadimos las líneas de la razón de cambio.\n  geom_vline(xintercept = c(log2(0.5), log2(2)),linetype = \"dashed\") +\n  # Etiquetamos las líneas de la razón de cambio.\n  annotate(\"text\", x = log2(0.5), y = maxy, label = \"FC=1/2\", vjust = 0) +\n  annotate(\"text\", x = log2(2), y = maxy, label = \"FC=2\", vjust = 0) +\n  # Añadimos las líneas de los p-valores.\n  geom_hline(yintercept = c(-log10(0.05), -log10(0.01)), linetype = \"dashed\") +\n  # Etiquetamos las líneas de los p-valores.\n  annotate(\"text\", x = rangex+0.1, y = -log10(0.05), label = \"p=0.05\", hjust = 0) +\n  annotate(\"text\", x = rangex+0.1, y = -log10(0.01), label = \"p=0.01\", hjust = 0) +\n  theme(plot.margin = unit(c(2, 1, 1, 1), \"lines\")) +\n  coord_cartesian(xlim = c(-rangex, rangex), ylim = c(0, maxy), expand = FALSE, clip = \"off\")\nvplot\n\n\n\n\nTambién se pueden destacar algunos genes de interés en el gráfico mediante etiquetas.\n\n# Creamos un nuevo conjunto de datos con los genes a destacar\ndf_sig &lt;- df  |&gt; \n  filter(SYMBOL %in% c(\"Il15\", \"Il34\", \"Il24\"))\n\n# df_pvalor &lt;- data.frame(x)\n\nvplot &lt;- vplot +  \n  # Etiquetamos los genes a destacar\n  geom_label_repel(data = df_sig, aes(label = SYMBOL), force = 2, nudge_y = 1) \nvplot\n\n\n\n\nFinalmente, añadimos un título al diagrama.\n\nvplot +\n  labs(title = \"Diagrama de volcán\") +\n  theme(plot.title = element_text(margin=margin(0,0,25,0)))"
  }
]